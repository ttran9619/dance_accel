/*-----------------------------------------------------------------
-                           HackISU S2018
-              Valery S., Leif B., Emily A., Tyler T.
-----------------------------------------------------------------*/
#ifndef LED_OUT_H
#define LED_OUT_H

/*-----------------------------------------------------------------
-                           Includes
-----------------------------------------------------------------*/
#include "threaded_queue.hpp"
#include "audio_driver.hpp"

#include "serial/serial.h"

#include <string>

/*-----------------------------------------------------------------
-                        Literal Constants
-----------------------------------------------------------------*/

/*-----------------------------------------------------------------
-                           Enumerations
-----------------------------------------------------------------*/

/*-----------------------------------------------------------------
-                             Macros
-----------------------------------------------------------------*/

/*-----------------------------------------------------------------
-                        Forward Declarations
-----------------------------------------------------------------*/

/*-----------------------------------------------------------------
-                             Structs
-----------------------------------------------------------------*/

/*-----------------------------------------------------------------
-                             Typedefs
-----------------------------------------------------------------*/

/*-----------------------------------------------------------------
-                             Functors
-----------------------------------------------------------------*/

/*-----------------------------------------------------------------
-                             Classes
-----------------------------------------------------------------*/
class LEDOut
{
    public:
        LEDOut( std::string port )
            :out_dev( port,
                      BAUD_RATE,
                      serial::Timeout::simpleTimeout( 1000 ) )
        {
            if( !out_dev.isOpen() )
            {
                cout << "Connection Failed!" << endl;
                exit( -1 );
            }
            cout << "Connection Sucessful!" << endl;
        };

        ~LEDOut()
        {
            out_dev.close();
        };

        bool set_led( uint8_t aVal )
        {
            out_dev.write( &aVal, sizeof( uint8_t ) );
        }

    private:
        serial::Serial out_dev;
};

/*-----------------------------------------------------------------
-                             Prototypes
-----------------------------------------------------------------*/

#endif